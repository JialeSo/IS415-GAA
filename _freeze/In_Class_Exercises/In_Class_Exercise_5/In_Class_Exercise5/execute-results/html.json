{
  "hash": "c81feec9df904d0fce1066aad471700a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"In Class Exercise 5: Spatio-Temporal Point Patterns Analysis\"\nauthor: \"Jiale SO\"\ndate: \"September 09, 2024\"\ndate-modified: \"last-modified\"\nexecute: \n  eval: true  \n  echo: true\n  freeze: true\n  warning: false\n  message: false\n  cache: true\n---\n\n\n# 1.0 Introduction\n\nA spatio-temporal point process (also called space-time or spatial-temporal point process) is a random collection of points, where each point represents the time and location of an event. Examples of events include incidence of disease, sightings or births of a species, or the occurrences of fires, earthquakes, lightning strikes, tsunamis, or volcanic eruptions.\n\nThe analysis of spatio-temporal point patterns is becoming increasingly necessary, given the rapid emergence of geographically and temporally indexed data in a wide range of fields. Several spatio-temporal point patterns analysis methods have been introduced and implemented in R in the last ten years. This chapter shows how various R packages can be combined to run a set of spatio-temporal point pattern analyses in a guided and intuitive way. A real world forest fire events in Kepulauan Bangka Belitung, Indonesia from 1st January 2023 to 31st December 2023 is used to illustrate the methods, procedures and interpretations.\n\n## 1.1 Research Questions\n\nThe specific question we would like to answer is:\n\n-   are the locations of forest fire in Kepulauan Bangka Belitung spatial and spatio-temporally independent?\n\n-   if the answer is NO, where and when the observed forest fire locations tend to cluster?\n\n# 2.0 Setup and Requirements\n\nFor the purpose of this study, five R packages will be used. They are:\n\n-   `rgdal` for importing geospatial data in GIS file format such as shapefile into R and save them as Spatial\\*DataFrame,\n\n-   `maptools` for converting Spatial\\* object into ppp object,\n\n-   `raster` for handling raster data in R,\n\n-   `sparr` provides function to estimate fixed and adaptive kernel-smoothed spatial relative risk surfaces via the density-ratio method and perform subsequent inference. fixed-bandwidth spati=temporal density and relative risk estimation is also supported\n\n-   `spatstat` for performing Spatial Point Patterns Analysis such as kcross, Lcross, etc., and\n\n-   `tmap` for producing cartographic quality thematic maps\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(sf, raster, spatstat, sparr, tmap, tidyverse, stpp, skimr, GWmodel)\n```\n:::\n\n\nTwo data sets will be used in this hands-on exercise, they are:\n\n-   Hunan county boundary layer. This is a geospatial data set in ESRI shapefile format.\n\n-   Hunan_2012.csv: This csv file contains selected Hunanâ€™s local development indicators in 2012.\n\n::: panel-tabset\n## Importing Hunan ShapeFile\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan <- st_read(dsn = \"data/geospatial\", layer = \"Hunan\")\n```\n:::\n\n\n## importing Hunan Table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan2012 <- read_csv(\"data/aspatial/Hunan_2012.csv\")\n```\n:::\n\n\n## Joining\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan <- left_join(hunan,hunan2012, by=\"County\") %>%\n  select(1:3,7,9,16,31,32)\n```\n:::\n\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwrite_rds(hunan, \"data/rds/hunan_rds\")\n```\n:::\n\n::: {.cell}\n\n:::\n\n\n# 3.0 Geographically weighted summary statistic with adaptive bandwidth\n\n## 3.1 Determine adaptive bandwidth\n\n::: panel-tabset\n## Cross-Validation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_AIC <- bw.gwr(GDPPC ~ 1,\n            data = hunan_sp,\n            approach = \"CV f\",\n            adaptive = TRUE,\n            kernel = 'bisquare',\n            longlat = T\n                 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAdaptive bandwidth: 62 CV score: 18372757104 \nAdaptive bandwidth: 46 CV score: 18580353939 \nAdaptive bandwidth: 72 CV score: 18261945072 \nAdaptive bandwidth: 78 CV score: 18284736555 \nAdaptive bandwidth: 68 CV score: 18289290196 \nAdaptive bandwidth: 74 CV score: 18279018755 \nAdaptive bandwidth: 70 CV score: 18279860873 \nAdaptive bandwidth: 72 CV score: 18261945072 \n```\n\n\n:::\n:::\n\n\n## AIC\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_AIC <- bw.gwr(GDPPC ~ 1,\n            data = hunan_sp,\n            approach = \"AIC\",\n            adaptive = TRUE,\n            kernel = 'bisquare',\n            longlat = T\n                 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAdaptive bandwidth (number of nearest neighbours): 62 AICc value: 1938.23 \nAdaptive bandwidth (number of nearest neighbours): 46 AICc value: 1939.809 \nAdaptive bandwidth (number of nearest neighbours): 72 AICc value: 1937.17 \nAdaptive bandwidth (number of nearest neighbours): 78 AICc value: 1937.175 \nAdaptive bandwidth (number of nearest neighbours): 68 AICc value: 1937.494 \nAdaptive bandwidth (number of nearest neighbours): 74 AICc value: 1937.232 \nAdaptive bandwidth (number of nearest neighbours): 70 AICc value: 1937.334 \nAdaptive bandwidth (number of nearest neighbours): 72 AICc value: 1937.17 \n```\n\n\n:::\n:::\n\n:::\n\n## 3.2 Fixed Distance\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbw_AIC <- bw.gwr(GDPPC ~ 1,\n            data = hunan_sp,\n            approach = \"CV f\",\n            adaptive = FALSE,\n            kernel = 'bisquare',\n            longlat = T\n                 )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nFixed bandwidth: 12310.25 CV score: 18273921746 \nFixed bandwidth: 7609.674 CV score: 18103867978 \nFixed bandwidth: 4704.558 CV score: 16845755087 \nFixed bandwidth: 2909.098 CV score: Inf \nFixed bandwidth: 5814.214 CV score: 17412467531 \nFixed bandwidth: 4018.754 CV score: 17199641530 \nFixed bandwidth: 5128.409 CV score: 17049024078 \nFixed bandwidth: 4442.604 CV score: 16843054303 \nFixed bandwidth: 4280.708 CV score: 16938431975 \nFixed bandwidth: 4542.662 CV score: 16824565479 \nFixed bandwidth: 4604.501 CV score: 16826274857 \nFixed bandwidth: 4504.443 CV score: 16828132125 \nFixed bandwidth: 4566.282 CV score: 16824224135 \nFixed bandwidth: 4580.881 CV score: 16824638274 \nFixed bandwidth: 4557.26 CV score: 16824204920 \nFixed bandwidth: 4551.684 CV score: 16824284931 \nFixed bandwidth: 4560.706 CV score: 16824190674 \nFixed bandwidth: 4562.836 CV score: 16824195234 \nFixed bandwidth: 4559.39 CV score: 16824192954 \nFixed bandwidth: 4561.52 CV score: 16824191213 \nFixed bandwidth: 4560.204 CV score: 16824191084 \nFixed bandwidth: 4561.017 CV score: 16824190704 \nFixed bandwidth: 4560.514 CV score: 16824190763 \nFixed bandwidth: 4560.825 CV score: 16824190660 \nFixed bandwidth: 4560.898 CV score: 16824190667 \nFixed bandwidth: 4560.78 CV score: 16824190661 \nFixed bandwidth: 4560.853 CV score: 16824190661 \nFixed bandwidth: 4560.808 CV score: 16824190660 \nFixed bandwidth: 4560.836 CV score: 16824190660 \nFixed bandwidth: 4560.818 CV score: 16824190660 \nFixed bandwidth: 4560.814 CV score: 16824190660 \nFixed bandwidth: 4560.821 CV score: 16824190660 \nFixed bandwidth: 4560.817 CV score: 16824190660 \nFixed bandwidth: 4560.819 CV score: 16824190660 \nFixed bandwidth: 4560.818 CV score: 16824190660 \nFixed bandwidth: 4560.817 CV score: 16824190660 \nFixed bandwidth: 4560.818 CV score: 16824190660 \n```\n\n\n:::\n:::\n\n\nComputing Geographically weighted summary statistics\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngwstat <- gwss(data = hunan_sp,\n               vars = \"GDPPC\",\n               bw = bw_AIC,\n               kernel = \"bisquare\",\n               adaptive = TRUE,\n               longlat = T\n               )\n```\n:::\n\n\nPreparing the output data.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngwstat_df <- as.data.frame(gwstat$SDF)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhunan_gstat <- cbind(hunan_sf, gwstat_df)\n```\n:::\n\n\n## **The Geographically Weighted Mean**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntm_shape(hunan_gstat) +\n  tm_fill(\"GDPPC_LM\", \n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Dsitribution of geographically weighted mean\",\n            main.title.position = \"center\",\n            main.title.size = 2.0,\n            legend.text.size = 1.2,\n            legend.height = 1.50,\n            legend.width = 1.50,\n            frame = TRUE)\n```\n\n::: {.cell-output-display}\n![](In_Class_Exercise5_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}